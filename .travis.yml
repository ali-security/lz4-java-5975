language: java

jobs:
  include:
    - name: Linux test (amd64)
      os: linux
      arch: amd64
      dist: trusty
      install:
        - wget https://github.com/lz4/lz4/archive/v1.9.2.tar.gz
        - jdk_switcher use openjdk8
        - tar xzvf v1.9.2.tar.gz
        - pushd lz4-1.9.2 && make && sudo make install && popd
        - wget https://archive.apache.org/dist/ant/binaries/apache-ant-1.10.9-bin.tar.gz
        - tar xvzf apache-ant-1.10.9-bin.tar.gz
        - ./apache-ant-1.10.9/bin/ant ivy-bootstrap
        - ./apache-ant-1.10.9/bin/ant init
      script:
        - ./apache-ant-1.10.9/bin/ant dist
        - ./apache-ant-1.10.9/bin/ant test
        - ./apache-ant-1.10.9/bin/ant clean
        - ./apache-ant-1.10.9/bin/ant test-skip-jni

    - name: Linux test (arm64)
      os: linux
      arch: arm64
      install:
        - jdk_switcher use openjdk8
        - wget https://github.com/lz4/lz4/archive/v1.9.2.tar.gz
        - tar xzvf v1.9.2.tar.gz
        - pushd lz4-1.9.2 && make && sudo make install && popd
        - wget https://archive.apache.org/dist/ant/binaries/apache-ant-1.10.9-bin.tar.gz
        - tar xvzf apache-ant-1.10.9-bin.tar.gz
        - ./apache-ant-1.10.9/bin/ant ivy-bootstrap
        - ./apache-ant-1.10.9/bin/ant init
      script:
        - ./apache-ant-1.10.9/bin/ant dist
        - ./apache-ant-1.10.9/bin/ant test
        - ./apache-ant-1.10.9/bin/ant clean
        - ./apache-ant-1.10.9/bin/ant test-skip-jni

    - name: Linux test (ppc64le)
      os: linux
      arch: ppc64le
      install:
        - jdk_switcher use openjdk8
        - wget https://github.com/lz4/lz4/archive/v1.9.2.tar.gz
        - tar xzvf v1.9.2.tar.gz
        - pushd lz4-1.9.2 && make && sudo make install && popd
        - wget https://archive.apache.org/dist/ant/binaries/apache-ant-1.10.9-bin.tar.gz
        - tar xvzf apache-ant-1.10.9-bin.tar.gz
        - ./apache-ant-1.10.9/bin/ant ivy-bootstrap
        - ./apache-ant-1.10.9/bin/ant init
      script:
        - ./apache-ant-1.10.9/bin/ant dist
        - ./apache-ant-1.10.9/bin/ant test
        - ./apache-ant-1.10.9/bin/ant clean
        - ./apache-ant-1.10.9/bin/ant test-skip-jni

  